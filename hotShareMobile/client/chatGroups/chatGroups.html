<template name="chatGroups">
  <div class="chatGroups home">
    <div class="head">
      <strong>消息</strong>
      <div class="rightDropMenu dropdown">
          <div class="rightButton dropdown-toggle" id="add-more" data-toggle="dropdown">
            <img src="/add_more.png" height="30" >
          </div>
          <ul class="dropdown-menu" role="menu" aria-labelledby="add-more">
            <li role="presentation"><a id="joinTestChatGroups" role="menuitem" tabindex="-1" ><i class="fa fa-users add-more-drop-item"></i>加入公司</a></li>
            <li role="presentation"><a id="createNewChatGroups" role="menuitem" tabindex="-1" ><i class="fa fa-comment add-more-drop-item"></i>创建公司</a></li>
            <li role="presentation"><a id="addNewFriends" role="menuitem" tabindex="-1" ><span class="add-more-drop-item"><span class="fa fa-plus"></span><i class="fa fa-user"></i></span> 添加成员</a></li>
            <li role="presentation"><a id="scanbarcode" role="menuitem" tabindex="-1" ><img class="add-more-drop-item" src="/scan_b.png" height="30" style="margin-left: -15px;">扫一扫</a></li>
            {{#if isAndroid}}
            <li role="presentation"><a id="scanimage" role="menuitem" tabindex="-1" ><img class="add-more-drop-item" src="/scan_b.png" height="30" style="margin-left: -15px;">扫图片</a></li>
            {{/if}}
          </ul>
      </div>
    </div>
    <div class="content">
    <div class="contentList" id="wrapper" style="overflow: hidden;">
        <!-- {{#if loading}}
          <div>{{_ "isLoading"}}</div>
        {{/if}}
        {{#if loadError}}
            <div>{{_ "loadFailNotification"}}</div>
        {{/if}} -->
        <ul id="msg-session">
          {{#if hasSysMessages}}
            <div id="sysBell" class="eachViewer swiperElem" style="position: relative;">
              <div>
                <img class="icon" src="/sysMessages.png">
                <span class="groupsName">考勤提醒</span>
                {{#if showRedSpot}}
                  <div class="red_spot" style="width: 14px;height: 14px;line-height: 20px;text-align: center;border-radius: 50%;background-color: red;color: #fff;position: absolute;left: 50px;top: 5px;z-index: 99;"></div>
                {{/if}}
              </div>
              <div class="delBtnContent sysDelBtn">删除</div>
            </div>
            <div class="line">
                  <span></span>
            </div>
          {{/if}}
          {{#each msgSession2}}
          <li class="swiperElem">
            {{#if toUserIcon}}
            <img class="icon" src="{{toUserIcon}}" />
            {{else}}
            <i class="fa fa-users" aria-hidden="true"></i>
            {{/if}}
            <div class="name">{{toUserName}}</div>
            <div class="text">{{lastText}}</div>
            <div class="time">{{formatTime updateAt}}</div>
            {{#if hasCount count}}
            <div class="count"></div>
            {{/if}}
            <div id="{{_id}}" class="delBtnContent" data-type="{{sessionType}}" data-touserid="{{toUserId}}">删除</div>
          </li>
          {{/each}}
        </ul>
        <!-- {{#if moreResults}}
        <div id="showMoreResults" style="margin-left: 25px;">
          <span class="loading">{{_ "loading"}}</span>
        </div>
        {{/if}} -->
    </div>
    </div>
    {{> footer}}
  </div>
  {{#if showBubbleTipHintTemplate}}
    {{> bubbleTipHintTemplate}}
  {{/if}}
  <script>
  $(function() {
    touch.on('body', 'swipeup swipedown', function(ev){
      console.log("swipe: ",ev.type );
      $('.swiperElem').animate({left: '0px'},100);
    });
    touch.live('#msg-session', 'swipeup swipedown','.swiperElem', function(ev){
      $('.swiperElem').animate({left: '0px'},100);
    });
    touch.live('#msg-session', 'swipeleft swipeing','.swiperElem', function(ev){
      $('.swiperElem').animate({left: '0px'},100);
      var x = ev.x;
      if(x < -40){
        x = -100;
      } else {
        x = 0;
      }
      console.log($(ev.target))
      $(ev.target).parents('.swiperElem').animate({left: x+'px'},100);
    });
    touch.live('#msg-session', 'swiperight swipeing','.swiperElem', function(ev){
      $(ev.target).parents('.swiperElem').animate({left: '0px'},100);
    });
  })
  </script>
</template>
